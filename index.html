async function startSession() {
    try {
        console.log('Démarrage pour agent:', currentAgent);
        
        const data = await callVoiceflowAPI({
            type: 'launch'
        });

        console.log('Réponse launch:', data);
        
        loadingMessage.style.display = 'none';
        messageInput.disabled = false;
        sendButton.disabled = false;
        messageInput.focus();
        
        if (data && data.length > 0) {
            processVoiceflowResponse(data);
        }

        // Envoi immédiat de l'agent ID après le launch
        try {
            console.log('Envoi immédiat agent ID:', currentAgent);
            const agentData = await callVoiceflowAPI({
                type: 'text',
                payload: currentAgent
            });
            console.log('Agent ID envoyé, réponse:', agentData);
            processVoiceflowResponse(agentData);
        } catch (error) {
            console.error('Erreur envoi agent ID:', error);
            // Réessayer après 2 secondes
            setTimeout(async () => {
                try {
                    const retryData = await callVoiceflowAPI({
                        type: 'text',
                        payload: currentAgent
                    });
                    processVoiceflowResponse(retryData);
                } catch (retryError) {
                    console.error('Retry échoué:', retryError);
                }
            }, 2000);
        }
        
    } catch (error) {
        console.error('Erreur:', error);
        loadingMessage.textContent = `Erreur: ${error.message}`;
        loadingMessage.style.color = 'red';
    }
}
